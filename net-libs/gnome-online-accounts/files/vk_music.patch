From 8156865ea435164bf290707fcae605905cbcb5c8 Mon Sep 17 00:00:00 2001
From: George Sedov <radist.morse@gmail.com>
Date: Sat, 23 May 2015 13:31:52 +0300
Subject: [PATCH 1/2] a new org.gnome.OnlineAccounts.Music interface for music
 related services

---
 data/dbus-interfaces.xml         | 20 +++++++++++++++++
 doc/goa-docs.xml                 |  2 ++
 doc/goa-sections.txt             | 46 ++++++++++++++++++++++++++++++++++++++++
 doc/goa.types                    |  3 +++
 src/goabackend/goabackendenums.h |  2 ++
 5 files changed, 73 insertions(+)

diff --git a/data/dbus-interfaces.xml b/data/dbus-interfaces.xml
index 095082e..6f8c5fe 100644
--- a/data/dbus-interfaces.xml
+++ b/data/dbus-interfaces.xml
@@ -186,6 +186,17 @@
     -->
     <property name="MapsDisabled" type="b" access="readwrite"/>
 
+    <!-- MusicDisabled:
+         If %TRUE, the account will not expose any
+         #org.gnome.OnlineAccounts.Music interface. If the account does not
+         provide music search and listening capabilities, this property does
+         nothing.
+
+         Note that the #org.gnomeOnlineAccounts.Music interface is added or
+         removed from the account asynchronously.
+    -->
+    <property name="MusicDisabled" type="b" access="readwrite"/>
+
     <!-- PrintersDisabled:
          @since: 3.12.0
 
@@ -643,6 +654,15 @@
   </interface>
 
   <!--
+      org.gnome.OnlineAccounts.Music:
+
+      An account object implements this interface if it provides
+      music listening and searching capabilities.
+  -->
+  <interface name="org.gnome.OnlineAccounts.Music">
+  </interface>
+
+  <!--
       org.gnome.OnlineAccounts.Photos:
       @since: 3.8.0
 
diff --git a/doc/goa-docs.xml b/doc/goa-docs.xml
index 1814225..55a3558 100644
--- a/doc/goa-docs.xml
+++ b/doc/goa-docs.xml
@@ -122,6 +122,7 @@
       <xi:include href="../src/goa/goa-generated-doc-org.gnome.OnlineAccounts.Chat.xml"/>
       <xi:include href="../src/goa/goa-generated-doc-org.gnome.OnlineAccounts.Documents.xml"/>
       <xi:include href="../src/goa/goa-generated-doc-org.gnome.OnlineAccounts.Maps.xml"/>
+      <xi:include href="../src/goa/goa-generated-doc-org.gnome.OnlineAccounts.Music.xml"/>
       <xi:include href="../src/goa/goa-generated-doc-org.gnome.OnlineAccounts.Photos.xml"/>
       <xi:include href="../src/goa/goa-generated-doc-org.gnome.OnlineAccounts.Files.xml"/>
       <xi:include href="../src/goa/goa-generated-doc-org.gnome.OnlineAccounts.Exchange.xml"/>
@@ -150,6 +151,7 @@
       <xi:include href="xml/GoaChat.xml"/>
       <xi:include href="xml/GoaDocuments.xml"/>
       <xi:include href="xml/GoaMaps.xml"/>
+      <xi:include href="xml/GoaMusic.xml"/>
       <xi:include href="xml/GoaPhotos.xml"/>
       <xi:include href="xml/GoaFiles.xml"/>
       <xi:include href="xml/GoaExchange.xml"/>
diff --git a/doc/goa-sections.txt b/doc/goa-sections.txt
index 27c953d..73509c4 100644
--- a/doc/goa-sections.txt
+++ b/doc/goa-sections.txt
@@ -58,6 +58,7 @@ goa_object_get_contacts
 goa_object_get_chat
 goa_object_get_documents
 goa_object_get_maps
+goa_object_get_music
 goa_object_get_photos
 goa_object_get_files
 goa_object_get_exchange
@@ -71,6 +72,7 @@ goa_object_peek_contacts
 goa_object_peek_chat
 goa_object_peek_documents
 goa_object_peek_maps
+goa_object_peek_music
 goa_object_peek_photos
 goa_object_peek_files
 goa_object_peek_exchange
@@ -90,6 +92,7 @@ goa_object_skeleton_set_contacts
 goa_object_skeleton_set_chat
 goa_object_skeleton_set_documents
 goa_object_skeleton_set_maps
+goa_object_skeleton_set_music
 goa_object_skeleton_set_photos
 goa_object_skeleton_set_files
 goa_object_skeleton_set_exchange
@@ -159,6 +162,8 @@ goa_account_get_documents_disabled
 goa_account_set_documents_disabled
 goa_account_get_maps_disabled
 goa_account_set_maps_disabled
+goa_account_get_music_disabled
+goa_account_set_music_disabled
 goa_account_get_photos_disabled
 goa_account_set_photos_disabled
 goa_account_get_files_disabled
@@ -898,6 +903,47 @@ goa_maps_skeleton_get_type
 </SECTION>
 
 <SECTION>
+<FILE>GoaMusic</FILE>
+GoaMusic
+GoaMusicIface
+goa_music_interface_info
+goa_music_override_properties
+GoaMusicProxy
+GoaMusicProxyClass
+goa_music_proxy_new
+goa_music_proxy_new_finish
+goa_music_proxy_new_sync
+goa_music_proxy_new_for_bus
+goa_music_proxy_new_for_bus_finish
+goa_music_proxy_new_for_bus_sync
+GoaMusicSkeleton
+GoaMusicSkeletonClass
+goa_music_skeleton_new
+<SUBSECTION Standard>
+GOA_TYPE_MUSIC
+GOA_IS_MUSIC
+GOA_MUSIC
+GOA_MUSIC_GET_IFACE
+GOA_TYPE_MUSIC_PROXY
+GOA_IS_MUSIC_PROXY
+GOA_IS_MUSIC_PROXY_CLASS
+GOA_MUSIC_PROXY
+GOA_MUSIC_PROXY_CLASS
+GOA_MUSIC_PROXY_GET_CLASS
+GOA_TYPE_MUSIC_SKELETON
+GOA_IS_MUSIC_SKELETON
+GOA_IS_MUSIC_SKELETON_CLASS
+GOA_MUSIC_SKELETON
+GOA_MUSIC_SKELETON_CLASS
+GOA_MUSIC_SKELETON_GET_CLASS
+GoaMusicProxyPrivate
+GoaMusicSkeletonPrivate
+goa_music_get_type
+goa_music_proxy_get_type
+goa_music_skeleton_get_type
+</SECTION>
+
+<SECTION>
 <FILE>GoaPhotos</FILE>
 GoaPhotos
 GoaPhotosIface
diff --git a/doc/goa.types b/doc/goa.types
index 32a2aec..c2daed1 100644
--- a/doc/goa.types
+++ b/doc/goa.types
@@ -36,6 +36,9 @@ goa_documents_skeleton_get_type
 goa_maps_get_type
 goa_maps_proxy_get_type
 goa_maps_skeleton_get_type
+goa_music_get_type
+goa_music_proxy_get_type
+goa_music_skeleton_get_type
 goa_photos_get_type
 goa_photos_proxy_get_type
 goa_photos_skeleton_get_type
diff --git a/src/goabackend/goabackendenums.h b/src/goabackend/goabackendenums.h
index eb4a447..042961d 100644
--- a/src/goabackend/goabackendenums.h
+++ b/src/goabackend/goabackendenums.h
@@ -70,6 +70,7 @@ typedef enum
  * @GOA_PROVIDER_FEATURE_READ_LATER: Read later services (eg. Pocket).
  * @GOA_PROVIDER_FEATURE_PRINTERS: Network printing services (e.g. Google Cloud Print).
  * @GOA_PROVIDER_FEATURE_MAPS: Maps related services (e.g. Foursquare, Facebook).
+ * @GOA_PROVIDER_FEATURE_MUSIC: Music related services (e.g. Vkontakte).
  * @GOA_PROVIDER_FEATURE_INVALID: Used for error handling. No provider
  *   should provide this feature.
  *
@@ -94,6 +95,7 @@ typedef enum /*< flags >*/
   GOA_PROVIDER_FEATURE_READ_LATER= 1 << 10,
   GOA_PROVIDER_FEATURE_PRINTERS  = 1 << 11,
   GOA_PROVIDER_FEATURE_MAPS      = 1 << 12,
+  GOA_PROVIDER_FEATURE_MUSIC     = 1 << 13,
   GOA_PROVIDER_FEATURE_INVALID   = 0
 } GoaProviderFeatures;
 
-- 
2.4.1

